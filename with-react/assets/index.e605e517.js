import{j as D,r as M,g as J,s as K,i as G,c as Q,o as U,a as V,b as P,R as X,d as Y}from"./vendor.c4f77d86.js";const Z=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function s(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerpolicy&&(a.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?a.credentials="include":o.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(o){if(o.ep)return;o.ep=!0;const a=s(o);fetch(o.href,a)}};Z();const d=D.exports.jsx,g=D.exports.jsxs,W=(t,r)=>(s,n)=>{const o=s[t],[a,c]=M.exports.useState(o(n));return M.exports.useEffect(()=>{const w=()=>c(o(n));return r.forEach(u=>n?s.on(n,u,w):s.on(u,w)),()=>r.forEach(u=>s.off(u,w))},[n,o,s]),a},_=W("isModified",["change","reset","validated"]),ee=W("isVisited",["focus","reset","validated"]),te=W("isDirty",["change","reset"]),se=W("errors",["validated"]),re=W("value",["change","reset"]),ne=(t,r,s)=>{for(const n of t)r(n)&&s(n)},I=(t,r)=>ne(t,r,s=>t.delete(s)),O=(t,r)=>{for(const s of t)if(r(s))return!0;return!1},oe=({get:t,set:r,isEqual:s,cloneDeep:n})=>({initial:a,validate:c=()=>{},validationTriggers:w=[]})=>{let u=n(a),h=n(u);const p=new Set,N=new Map,x=new Set,j=new Set;let v=!1,f,k;const F={blur:[],change:[],focus:[],reset:[],validated:[]},A=new WeakMap,b=(e,i)=>F[e].forEach(l=>l(i)),m={initial:e=>e===void 0?u:t(u,e),value:e=>e===void 0?h:t(h,e),isDirty:e=>!s(m.value(e),m.initial(e)),isActive:e=>e?!!(f==null?void 0:f.startsWith(e)):!!f,isModified:e=>v?!0:e?O(p,i=>i.startsWith(e)):p.size>0,isVisited:e=>v?!0:e?O(x,i=>i.startsWith(e)):x.size>0,change:(...e)=>e.length===1?B(e[0]):C(e[0],e[1]),blur:e=>{f=void 0,b("blur",e)},focus:e=>{f=e,x.add(e),v&&j.add(e),b("focus",e)},reset:(e=u)=>{u=n(e),h=n(e),v=!1,p.clear(),x.clear(),k=void 0,f=void 0,b("reset",void 0)},resetAt:(...e)=>{const[i,l]=e;e.length===2&&r(u,i,l),r(h,i,t(u,i)),I(p,S=>S.startsWith(i)),I(x,S=>S.startsWith(i)),v=!1,(f==null?void 0:f.startsWith(i))&&(f=void 0),b("reset",i)},on:(e,i,l)=>l===void 0?T(e,i):q(e,i,l),off:(e,i)=>$(e,i),submit:async e=>{if(v=!0,m.validate(),!m.isValid())throw new Error("invalid form data");return e(m.value()).then(()=>m.reset(m.value())).finally(()=>H())},validate:()=>{k=c(h),b("validated",void 0)},errors:()=>k,isValid:()=>k===void 0},B=e=>{h=n(e),p.add(""),b("change",void 0)},C=(e,i)=>{r(h,e,i),p.add(e),v&&N.set(e,i),b("change",e)},T=(e,i)=>{const l=()=>i();A.set(i,l),F[e].push(l)},q=(e,i,l)=>{const E=S=>{(!S||S.startsWith(e))&&l()};A.set(l,E),F[i].push(E)},$=(e,i)=>{const l=A.get(i);F[e]=F[e].filter(E=>E!==l)},H=()=>{j.forEach(e=>x.add(e)),j.clear(),N.forEach((e,i)=>m.change(i,e)),N.clear()};return w.forEach(e=>{m.on(e,()=>m.validate())}),m},ie=oe({get:J,set:K,isEqual:G,cloneDeep:Q}),ae=t=>new Promise(r=>setTimeout(r,t)),z=U({username:V(P(),4,233),password:V(P(),4,233),confirmation:V(P(),4,233)}),ce={passwordMismatch:"passwordMismatch"},de=t=>{console.info("validate",t);const[r]=z.validate(t);if(r)return r.failures().map(n=>{var o;return{code:(o=n.refinement)!=null?o:n.type,path:n.path.join("."),failure:n}});z.assert(t);const s=[];return t.password!==t.confirmation&&s.push({code:ce.passwordMismatch,path:"confirmation"}),s.length===0?void 0:s},ue=(t={})=>ie({initial:t,validate:de,validationTriggers:["change"]}),le=async t=>{await ae(750),console.info("Submitted:",t)};var y;(function(t){t.NotAsked="NotAsked",t.Pending="Pending",t.Failure="Failure",t.Success="Success"})(y||(y={}));const fe=({initialValue:t,onRegister:r=le})=>{var u;const s=M.exports.useMemo(()=>ue(t),[t]),[n,o]=M.exports.useState(y.NotAsked),a=te(s),c=(u=se(s))!=null?u:[];return g("form",{onSubmit:h=>{h.preventDefault(),s.submit(p=>(o(y.Pending),r(p).then(()=>o(y.Success)).catch(()=>o(y.Failure))))},className:"form",children:[g("label",{children:["Submission state: ",n,d("br",{}),"Form validity: ",c.length>0?"Invalid":"Valid"]}),g("label",{children:["Dirty: ",JSON.stringify(a)]}),n===y.Pending&&d("div",{className:"dimmer"}),g("label",{children:["Name",d(L,{form:s,path:"username"}),d(R,{form:s,path:"username",errors:c})]}),g("label",{children:["Password",d(L,{type:"password",form:s,path:"password"}),d(R,{form:s,path:"password",errors:c})]}),g("label",{children:["Confirm password",d(L,{type:"password",form:s,path:"confirmation"}),d(R,{form:s,path:"confirmation",errors:c})]}),d("div",{style:{textAlign:"center"},children:d("button",{type:"submit",children:"Submit"})})]})},R=({form:t,path:r,errors:s})=>{const n=M.exports.useMemo(()=>s.filter(c=>c.path===r),[s,r]),o=_(t,r),a=ee(t,r);return n.length===0||!o&&!a?null:g("small",{className:"feedback-error",children:["Errors: ",n.map(c=>`"${c.code}"`).join(", ")]})},L=({type:t="text",form:r,path:s})=>{const n=re(r,s);return d("input",{type:t,value:n!=null?n:"",onChange:o=>{r.change(s,o.target.value||void 0),console.info("change",{path:s,value:o.target.value||void 0,form:r.value()})},onFocus:()=>r.focus(s),onBlur:()=>r.blur(s)})};function me(){return g("div",{className:"app",children:[d("h2",{children:"Registration form"}),d("p",{children:"Open console to see submitted values \u{1F609}"}),d(fe,{})]})}X.render(d(Y.StrictMode,{children:d(me,{})}),document.getElementById("root"));
